apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: knative-serving-cert
  namespace: istio-system
spec:
  secretName: knative-serving-cert
  commonName: knative.beansnet.net
  dnsNames:
  - knative.beansnet.net
  - "*.knative.beansnet.net"
  issuerRef:
    name: letsencrypt-dns-prod
    kind: ClusterIssuer
---
apiVersion: operator.knative.dev/v1beta1
kind: KnativeServing
metadata:
  name: knative-serving
  namespace: knative-serving
spec:
  ingress:
    istio:
      enabled: true
      knative-ingress-gateway:
        selector:
          istio: ingress
        servers:
        - port:
            number: 443
            name: https
            protocol: HTTPS
          hosts:
          - knative.beansnet.net
          - "*.knative.beansnet.net"
          tls:
            mode: SIMPLE
            credentialName: knative-serving-cert
  config:
    domain:
      "knative.beansnet.net": ""
      "*.knative.beansnet.net": ""
  high-availability:
    replicas: 1
